<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MyTaxiStuttgart</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f4f4;
  }
  header {
    background-color: #0073e6;
    color: #fff;
    padding: 20px;
    text-align: center;
  }
  header h1 {
    margin: 0;
    font-size: 2em;
  }
  nav {
    background-color: #005bb5;
    display: flex;
    justify-content: center;
  }
  nav a {
    color: #fff;
    padding: 14px 20px;
    text-decoration: none;
  }
  nav a:hover {
    background-color: #004999;
  }
  main {
    padding: 20px;
  }
  section {
    margin-bottom: 40px;
  }
  h2 {
    color: #0073e6;
  }
  /* Kontakt & Leistungen */
  .kontakt, .leistungen {
    background-color: #fff;
    padding: 15px;
    border-radius: 8px;
  }
  /* Buchungsformular */
  .buchung-form {
    background-color: #fff;
    padding: 15px;
    border-radius: 8px;
  }
  input[type="text"], input[type="number"], select {
    width: 100%;
    padding: 8px;
    margin-top: 6px;
    margin-bottom: 12px;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
  button {
    background-color: #0073e6;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }
  button:hover {
    background-color: #005bb5;
  }
  /* Zahlungsoptionen */
  #buchenSection {
    display: none;
    margin-top: 20px;
  }
</style>
</head>
<body>

<header>
  <h1>MyTaxiStuttgart</h1>
  <p>Ihr zuverlässiges Taxi in Stuttgart und Umgebung</p>
</header>

<nav>
  <a href="#start">Startseite</a>
  <a href="#leistungen">Leistungen</a>
  <a href="#kontakt">Kontakt</a>
  <a href="#buchung">Buchung</a>
</nav>

<main>
  <!-- Startseite -->
  <section id="start">
    <h2>Willkommen bei MyTaxiStuttgart</h2>
    <p>Wir bieten schnelle, sichere und komfortable Fahrten in Stuttgart und Umgebung. Ob Flughafentransfer, Stadtrundfahrt oder Privatfahrt – wir sind für Sie da!</p>
  </section>

  <!-- Leistungen -->
  <section id="leistungen" class="leistungen">
    <h2>Unsere Leistungen</h2>
    <ul>
      <li>Flughafentransfers</li>
      <li>Stadtfahrten</li>
      <li>Geschäftsreisen</li>
      <li>Privat- und Gruppentransporte</li>
      <li>24/7 Service</li>
    </ul>
  </section>

  <!-- Kontakt -->
  <section id="kontakt" class="kontakt">
    <h2>Kontakt & Öffnungszeiten</h2>
    <p><strong>Telefon:</strong> 0711 12345678</p>
    <p><strong>E-Mail:</strong> info@mytaxistuttgart.de</p>
    <p><strong>Adresse:</strong> Beispielstraße 10, 70173 Stuttgart</p>
    <p><strong>Öffnungszeiten:</strong> Montag - Sonntag, 06:00 - 23:00 Uhr</p>
  </section>

  <!-- Buchung -->
  <section id="buchung">
    <h2>Fahrpreis berechnen & buchen</h2>
    <div class="buchung-form">
      <label for="start">Startadresse:</label>
      <input type="text" id="start" placeholder="z.B. Hauptstraße 5, Stuttgart" />

      <label for="ziel">Zieladresse:</label>
      <input type="text" id="ziel" placeholder="z.B. Flughafen Stuttgart" />

      <label><input type="checkbox" id="reservieren" /> Reservierung vorab?</label><br><br>

      <button onclick="berechnePreis()">Preis anzeigen</button>
    </div>
    <p id="ergebnis" style="font-weight: bold; margin-top: 10px;"></p>

    <!-- Zahlungsoptionen -->
    <div id="buchenSection">
      <h3>Zahlungsart wählen:</h3>
      <label><input type="radio" name="zahlungsart" value="Kreditkarte" /> Kreditkarte</label><br>
      <label><input type="radio" name="zahlungsart" value="Barzahlung" /> Barzahlung</label><br>
      <label><input type="radio" name="zahlungsart" value="PayPal" /> PayPal</label><br><br>
      <button onclick="buchen()">Buchen</button>
    </div>
  </section>
</main>

<script>
// Variablen zum Speichern
let aktuellerPreis = 0;
let aktuellerStart = '';
let aktuellerZiel = '';

// Funktion zur Preisberechnung
function berechnePreis() {
  const start = document.getElementById('start').value.trim();
  const ziel = document.getElementById('ziel').value.trim();
  const reservieren = document.getElementById('reservieren').checked;

  if (!start || !ziel) {
    alert('Bitte Start- und Zieladresse eingeben.');
    return;
  }

  // Geocoding mit Nominatim API
  fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(start)}`)
    .then(res => res.json())
    .then(startData => {
      if (startData.length === 0) throw 'Startadresse nicht gefunden.';
      const startCoords = [parseFloat(startData[0].lat), parseFloat(startData[0].lon)];

      return fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(ziel)}`)
        .then(res => res.json())
        .then(zielData => {
          if (zielData.length === 0) throw 'Zieladresse nicht gefunden.';
          const zielCoords = [parseFloat(zielData[0].lat), parseFloat(zielData[0].lon)];

          const dist = haversineDistance(startCoords, zielCoords);
          const grundpreis = 5; // € Grundpreis
          const preisProKm = 2; // € pro km
          let preis = grundpreis + (dist * preisProKm);

          if (reservieren) {
            preis += 3; // Reservierungsgebühr
          }

          // Speichern
          aktuellerPreis = preis;
          aktuellerStart = start;
          aktuellerZiel = ziel;

          document.getElementById('ergebnis').innerText = `Von ${start} zum ${ziel} – Preis: €${preis.toFixed(2)}`;
          document.getElementById('buchenSection').style.display = 'block';
        });
    })
    .catch(error => {
      document.getElementById('ergebnis').innerText = 'Fehler: ' + error;
      document.getElementById('buchenSection').style.display = 'none';
    });
}

// Buchung
function buchen() {
  const zahlungsart = document.querySelector('input[name="zahlungsart"]:checked');
  if (!zahlungsart) {
    alert('Bitte Zahlungsart wählen.');
    return;
  }
  if (zahlungsart.value === 'PayPal') {
    // Weiterleitung zu PayPal (Beispiel)
    window.location.href = 'https://www.paypal.com/de/signin'; // echte Zahlungs-URL einfügen
  } else {
    alert(`Vielen Dank! Ihre Buchung von ${aktuellerStart} nach ${aktuellerZiel} im Wert von €${aktuellerPreis.toFixed(2)} wurde mit ${zahlungsart.value} bestätigt.`);
  }
}

// Haversine-Formel zur Entfernung
function haversineDistance(coords1, coords2) {
  const toRad = angle => (angle * Math.PI) / 180;
  const R = 6371; // Erdradius in km
  const [lat1, lon1] = coords1;
  const [lat2, lon2] = coords2;

  const dLat = toRad(lat2 - lat1);
  const dLon = toRad(lon2 - lon1);

  const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
            Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
            Math.sin(dLon/2) * Math.sin(dLon/2);
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
  return R * c; // Entfernung in km
}
</script>

</body>
</html>
